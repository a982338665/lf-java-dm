
> https://eco.dameng.com/document/dm/zh-cn/app-dev/java-jdbc.html

四、常见问题
1. JDBC 中使用 setNull 方法给 varchar 类型绑定空值报错：字符串转换出错

【问题描述】：通过如下语句给 varchar 类型绑定空值报错：字符转换出错。

Copy
String sql = "select * from sysobjects where name=?";
PreparedStatement stmt = conn.prepareStatement(sql);
stmt.setNull(1, 0);
stmt.execute();
conn.commit();
【问题解决】：出现该报错是由于达梦默认 null 和空串不等价，解决办法如下：

修改 dm.ini，令 COMPATIBLE_MODE = 2；
重启数据库服务后生效
2. jdbc 程序中如何获取存储过程的元数据信息

【问题描述】：利用如下程序获取存储过程的元数据信息，执行完后获取的元数据信息为空，jdbc 程序代码片段如下：

Copy
DatabaseMetaData dbMetaData = conn.getMetaData();
ResultSet rs = dbMetaData.getProcedureColumns("PERSONPACKAGE", dbMetaData.getUserName(), "ADDPERSON", null);
ResultSet rs = dbMetaData.getProcedureColumns("PERSONPACKAGE", dbMetaData.getUserName(), "ADDPERSON", null);
System.out.println("Get getProcedureColumns：");
while (rs.next()) {
System.out.println("PROCEDURE_NAME："+rs.getString("PROCEDURE_NAME"));
System.out.println("COLUMN_NAME："+rs.getString("COLUMN_NAME"));
}
【问题解决】：需要 JDBC 打开兼容 Oracle 模式，在 jdbc 的 url 串中添加 compatibleMode=oracle。
例如：jdbc:dm//localhost:5236?compatibleMode=oracle

3. 报错 JDK 包和驱动不匹配 driver dm.jdbc.driver.DmDriver is not sequoia compliant

【问题描述】：连接数据库时报错：driver dm.jdbc.driver.DmDriver is not sequoia compliant

image.png

【问题解决】：更换 JDK 包就可以了。连接池的连接问题：连接要使用 DM 安装数据库后自带的 JDK 包。

4. JDBC 驱动连接数据库报错：failed to initialize ssl

【问题描述】：由于未配置 SSL 环境而使用 SSL 登录。

【问题解决】：可以关闭 SSL 参数。使用 sysdba 登录执行以下语句：

Copy
SP_SET_PARA_VALUE(2,'ENABLE_ENCRYPT',0);
然后重启达梦数据库服务即可。
